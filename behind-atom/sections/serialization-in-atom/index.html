<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>Serialization in Atom</title>

<link rel="stylesheet" media="all" href="/assets/stylesheets/application.css" data-proofer-ignore>


<script type="text/javascript" src="/assets/javascripts/application.js"></script>

<script type="text/javascript">
  $(function() {
    $('#quicksearch-query').lunrSearch({

      indexUrl: '/search.json',

      quickSearchResults:  '.autocomplete-results',
      quickSearchEntries:  '.result-group',
      quickSearchTemplate: '#quicksearch-results-template',

      searchResults: '.search-container',
      searchEntries: '.search-results',
      searchTemplate: '#search-results-template'
    })
  })
</script>

    <link rel="shortcut icon" href="http://flight-manual.atom.io/assets/images/favicon.ico" />

  </head>
  <body class="layout-article">
    <div class="footer-push">
      <div class="top-bar">
  <div class="wrapper no-pad">

    <ul class="navigation">
      <li><h1 title="Atom: A hackable text editor for the 21st Century"><a href="https://atom.io/" class="logo-small"></a></h1></li>
      <li><a href="https://atom.io/packages">Packages</a></li>
      <li><a href="https://atom.io/themes">Themes</a></li>
      <li><a href="https://atom.io/docs" class="is-selected">Documentation</a></li>
      <li><a href="http://blog.atom.io">Blog</a></li>
      <li><a href="http://discuss.atom.io">Discuss</a></li>
    </ul>

  </div>
</div>

      <div class="wrapper documents content-push wide">
        <script id="quicksearch-results-template" type="text/mustache">
  [[#entries]]
    <a href="[[url]]" class="js-articles-quicksearch-link">[[title]]</a>
  [[/entries]]
  <a class="initial quicksearch-seemore" href="/search?q=">See more results</a>
</script>

<script id="search-results-template" type="text/mustache">
  [[#entries]]
    <li>
      <h3>
        <a href="[[url]]">[[title]]</a>
        <div class="label"><a href="[[category_url]]">[[category]]</a></div>
      </h3>
      <p>
      [[excerpt]]
      </p>
    </li>
  [[/entries]]
</script>

<div class="documents-search">
  <form accept-charset="UTF-8" action="/search" id="articles-search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="âœ“"></div>
    <input type="search" name="q" id="quicksearch-query" class="documents-search-input js-articles-quicksearch" placeholder="Search the Flight Manual" autocomplete="off">
  </form>
</div>

<div class="autocomplete-results" style="display: none;">
  <div class="result-group"></div>
</div>


        <div class="toc">
          


  <h4>
    <a href="/getting-started">Chapter 1: Getting Started</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/getting-started/sections/why-atom">Why Atom?</a>
      </li>
    
      <li class="unselected">
        <a href="/getting-started/sections/installing-atom">Installing Atom</a>
      </li>
    
      <li class="unselected">
        <a href="/getting-started/sections/atom-basics">Atom Basics</a>
      </li>
    
      <li class="unselected">
        <a href="/getting-started/sections/summary">Summary</a>
      </li>
    
  </ul>

  <h4>
    <a href="/using-atom">Chapter 2: Using Atom</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/using-atom/sections/atom-packages">Atom Packages</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/moving-in-atom">Moving in Atom</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/atom-selections">Atom Selections</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/editing-and-deleting-text">Editing and Deleting Text</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/find-and-replace">Find and Replace</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/snippets">Snippets</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/autocomplete">Autocomplete</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/folding">Folding</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/panes">Panes</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/pending-pane-items">Pending Pane Items</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/grammar">Grammar</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/version-control-in-atom">Version Control in Atom</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/writing-in-atom">Writing in Atom</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/basic-customization">Basic Customization</a>
      </li>
    
      <li class="unselected">
        <a href="/using-atom/sections/summary">Summary</a>
      </li>
    
  </ul>

  <h4>
    <a href="/hacking-atom">Chapter 3: Hacking Atom</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/tools-of-the-trade">Tools of the Trade</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/the-init-file">The Init File</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/package-word-count">Package: Word Count</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/package-modifying-text">Package: Modifying Text</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/creating-a-theme">Creating a Theme</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/iconography">Iconography</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/debugging">Debugging</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/writing-specs">Writing specs</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/cross-platform-compatibility">Cross-Platform Compatibility</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/converting-from-textmate">Converting from TextMate</a>
      </li>
    
      <li class="unselected">
        <a href="/hacking-atom/sections/summary">Summary</a>
      </li>
    
  </ul>

  <h4>
    <a href="/behind-atom">Chapter 4: Behind Atom</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/behind-atom/sections/configuration-api">Configuration API</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/keymaps-in-depth">Keymaps In-Depth</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/scoped-settings-scopes-and-scope-descriptors">Scoped Settings, Scopes and Scope Descriptors</a>
      </li>
    
      <li class="selected">
        <a href="/behind-atom/sections/serialization-in-atom">Serialization in Atom</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/developing-node-modules">Developing Node Modules</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/interacting-with-other-packages-via-services">Interacting With Other Packages Via Services</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/maintaining-your-packages">Maintaining Your Packages</a>
      </li>
    
      <li class="unselected">
        <a href="/behind-atom/sections/summary">Summary</a>
      </li>
    
  </ul>



  <h4>
    <a href="/resources">Appendix A: Resources</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/resources/sections/glossary">Glossary</a>
      </li>
    
  </ul>

  <h4>
    <a href="/upgrading-to-1-0-apis">Appendix B: Upgrading to 1.0 APIs</a>
  </h4>
  <ul>
    
      <li class="unselected">
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-package">Upgrading Your Package</a>
      </li>
    
      <li class="unselected">
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-ui-theme-or-package-selectors">Upgrading Your UI Theme Or Package Selectors</a>
      </li>
    
      <li class="unselected">
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-syntax-theme">Upgrading Your Syntax Theme</a>
      </li>
    
  </ul>


        </div>

        
        <h1 class="document-title">
          <div id="platform-nav">
  <span class="octicon octicon-device-desktop"></span>
  <ul>
    <li class="platform-mac">
      <a href="#platform-mac" data-platform="mac">
        mac
      </a>
    </li>
    <li class="platform-windows">
      <a href="#platform-windows" data-platform="windows">
        windows
      </a>
    </li>
    <li class="platform-linux">
      <a href="#platform-linux" data-platform="linux">
        linux
      </a>
    </li>
  </ul>
</div>

          <a class="improve-link"
              href="https://github.com/atom/flight-manual.atom.io/edit/master/content/behind-atom/sections/serialization-in-atom.md" data-proofer-ignore>
            <span class="octicon octicon-pencil"></span> Improve this page
          </a>
        </h1>

        <div class="markdown-body document-content">
          
          <h3>
<a id="serialization-in-atom" class="anchor" href="#serialization-in-atom" aria-hidden="true"><span class="octicon octicon-link"></span></a>Serialization in Atom</h3>

<p>When a window is refreshed or restored from a previous session, the view and its associated objects are <em>deserialized</em> from a JSON representation that was stored during the window's previous shutdown. For your own views and objects to be compatible with refreshing, you'll need to make them play nicely with the serializing and deserializing.</p>

<h4>
<a id="package-serialization-hook" class="anchor" href="#package-serialization-hook" aria-hidden="true"><span class="octicon octicon-link"></span></a>Package Serialization Hook</h4>

<p>Your package's main module can optionally include a <code>serialize</code> method, which will be called before your package is deactivated. You should return JSON, which will be handed back to you as an argument to <code>activate</code> next time it is called. In the following example, the package keeps an instance of <code>MyObject</code> in the same state across refreshes.</p>

<pre class="highlight highlight-coffee-script"><code><span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span>
  <span class="na">activate</span><span class="o">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="vi">@</span><span class="na">myObject</span> <span class="o">=</span>
      <span class="k">if</span> <span class="nx">state</span>
        <span class="nx">atom</span><span class="p">.</span><span class="na">deserializers</span><span class="p">.</span><span class="na">deserialize</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">new</span> <span class="nx">MyObject</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)</span>

  <span class="na">serialize</span><span class="o">:</span> <span class="o">-&gt;</span>
    <span class="vi">@</span><span class="na">myObject</span><span class="p">.</span><span class="na">serialize</span><span class="p">()</span>
</code></pre>


<h4>
<a id="serialization-methods" class="anchor" href="#serialization-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Serialization Methods</h4>

<pre class="highlight highlight-coffee-script"><code><span class="k">class</span> <span class="nx">MyObject</span>
  <span class="nx">atom</span><span class="p">.</span><span class="na">deserializers</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>

  <span class="vi">@</span><span class="na">deserialize</span><span class="o">:</span> <span class="p">({</span><span class="nx">data</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nx">MyObject</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="na">constructor</span><span class="o">:</span> <span class="p">(</span><span class="vi">@</span><span class="na">data</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="na">serialize</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="na">deserializer</span><span class="o">:</span> <span class="s">'MyObject'</span><span class="p">,</span> <span class="na">data</span><span class="o">:</span> <span class="vi">@</span><span class="na">data</span> <span class="p">}</span>
</code></pre>


<h5>
<a id="serialize" class="anchor" href="#serialize" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>serialize()</code>
</h5>

<p>Objects that you want to serialize should implement <code>.serialize()</code>. This method should return a serializable object, and it must contain a key named <code>deserializer</code> whose value is the name of a registered deserializer that can convert the rest of the data to an object. It's usually just the name of the class itself.</p>

<h5>
<a id="deserializedata" class="anchor" href="#deserializedata" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>deserialize(data)</code>
</h5>

<p>The other side of the coin is the <code>deserialize</code> method, which is usually a class-level method on the same class that implements <code>serialize</code>. This method's job is to convert a state object returned from a previous call <code>serialize</code> back into a genuine object.</p>

<h5>
<a id="atomdeserializersaddklass" class="anchor" href="#atomdeserializersaddklass" aria-hidden="true"><span class="octicon octicon-link"></span></a>atom.deserializers.add(klass)</h5>

<p>You need to call the <code>atom.deserializers.add</code> method with your class in order to make it available to the deserialization system. Now you can call the global <code>deserialize</code> method with state returned from <code>serialize</code>, and your class's <code>deserialize</code> method will be selected automatically.</p>

<h4>
<a id="versioning" class="anchor" href="#versioning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Versioning</h4>

<pre class="highlight highlight-coffee-script"><code><span class="k">class</span> <span class="nx">MyObject</span>
  <span class="nx">atom</span><span class="p">.</span><span class="na">deserializers</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>

  <span class="vi">@</span><span class="na">version</span><span class="o">:</span> <span class="mi">2</span>
  <span class="vi">@</span><span class="na">deserialize</span><span class="o">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">...</span>
  <span class="na">serialize</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="na">version</span><span class="o">:</span> <span class="vi">@</span><span class="na">constructor</span><span class="p">.</span><span class="na">version</span><span class="p">,</span> <span class="p">...</span> <span class="p">}</span>
</code></pre>


<p>Your serializable class can optionally have a class-level <code>@version</code> property and include a <code>version</code> key in its serialized state. When deserializing, Atom will only attempt to call deserialize if the two versions match, and otherwise return undefined. We plan on implementing a migration system in the future, but this at least protects you from improperly deserializing old state.</p>
        </div>
      </div>
      <div class="footer-pad"></div>
    </div>
    <footer>
  <div class="footer">
    <div class="wrapper no-pad">
      <ul class="footer-left">
        <li><a href="https://atom.io/terms">Terms of Use</a></li>
        <li><a href="https://help.github.com/articles/github-privacy-policy/">Privacy</a></li>
        <li><a href="http://github.com/atom/atom/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
        <li><a href="https://atom.io/releases">Releases</a></li>
        <li><a href="https://atom.io/faq">FAQ</a></li>
        <li><a href="https://atom.io/contact">Contact</a></li>
        <li><a href="https://github.com/atom/flight-manual.atom.io/blob/master/CONTRIBUTING.md">Contribute!</a></li>
      </ul>

      <div class="footer-right">
        <a href="https://github.com"><span class="octicon octicon-code"></span> with <span class="octicon octicon-heart"></span> by <span class="octicon octicon-logo-github"></span></a>
      </div>
    </div>
  </div>
</footer>

  </body>
</html>
